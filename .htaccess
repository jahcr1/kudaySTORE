# Activar reescritura
RewriteEngine On
RewriteBase /

##############################################
# üîí SEGURIDAD: BLOQUEAR ARCHIVOS SENSIBLES
##############################################

# Archivos ocultos como .env, .git, .htaccess
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

<FilesMatch "^(composer\.json|composer\.lock|config\.php|\.env)$">
    Order allow,deny
    Deny from all
</FilesMatch

# Bloquear acceso manual desde navegador a archivos sensibles
# pero permitir uso interno como AJAX o include()
<IfModule mod_rewrite.c>
    RewriteCond %{THE_REQUEST} ^GET\s.+(modificar_producto|eliminar_producto|descargar_pdf|cerrar|actualizar_carrito)\.php\sHTTP [NC]
    RewriteRule ^ - [F,L]
</IfModule>


# üîê Bloquear solo accesos directos tipo GET a archivos PHP en /componentes
RewriteCond %{THE_REQUEST} ^GET\s/+componentes/.*\.php\sHTTP/ [NC]
RewriteRule ^componentes/ - [F,L]



# Bloquear acceso a /vendor y /facturas desde navegador
RewriteRule ^(vendor|facturas)(/.*)?$ - [F,L]

##############################################
# üåê REDIRECCI√ìN HTTPS (si ten√©s SSL)
##############################################
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

##############################################
# üöÄ URLS AMIGABLES (ocultar .php)
##############################################
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^([^/]+)/?$ $1.php [L]

##############################################
# üîÅ RUTEO DE P√ÅGINAS
##############################################

DirectoryIndex index.php

# Rutas personalizadas
RewriteRule ^admin$ panel.php [L]
RewriteRule ^carrito$ carrito.php [L]
RewriteRule ^producto$ producto.php [L]
RewriteRule ^contacto$ contacto.php [L]

# Rutas para vistas
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(cartucheras|billeteras|bandoleras|bolsomatero|neceser|promociones|setmatero|varios)$ vistas/$1.php [L]
